<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>General :: OpenCPN Developer Manual</title>
    <link rel="canonical" href="http://localhost/opencpn/plugin-installer/0.0.1/Tarballs.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="http://localhost/opencpn">OpenCPN Developer Manual</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="plugin-installer" data-version="0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="Home.html">Plugin Installer Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugin Installer Documents</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Catalog.html">Catalog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="End-user-stories.html">End User Stories</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Home.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Installation-paths.html">Installation Paths</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Plugin-adaptation.html">Plugin Adaptation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Plugin-developer-use-case.html">Plugin Developer Use Case</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Program-design.html">Program Design</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="Tarballs.html">Tarballs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Terminology.html">Terminology</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Plugin Installer Documentation</span>
    <span class="version">0.0.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../ocpn-dev-manual/5.3.1/index.html">OpenCPN Developer Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ocpn-dev-manual/5.3.1/index.html">5.3.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="Home.html">Plugin Installer Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="Home.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../shipdriver/0.0.1/shipdriver.html">ShipDriver OpenCPN plugin docs.</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../shipdriver/0.0.1/shipdriver.html">0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../ocpn-dev-manual/5.3.1/developer_guide.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="Home.html">Plugin Installer Documentation</a></li>
    <li>Plugin Installer Documents</li>
    <li><a href="Tarballs.html">Tarballs</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/leamas/ocpn-pi-docs/edit/main/modules/ROOT/pages/Tarballs.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">General</h1>
<div class="paragraph">
<p>The general contract is that a plugin is made up of five kinds of files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The metadata.xml file [mandatory].</p>
</li>
<li>
<p>The dynamic library(.so/.dll/.dylib) [mandatory].</p>
</li>
<li>
<p>Optional helper binaries.</p>
</li>
<li>
<p>Data files</p>
</li>
<li>
<p>Translations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The tarball is the output from <strong>make install</strong> where these files are
located in the [System Install Dir](Terminology#system-install-path). In
other words, the plugin should work as expected if the tarball is
extracted on the system.</p>
</div>
<div class="paragraph">
<p>The plugin installer works by translating these typically read-only
paths to the rw [User Install path](Terminology#user-install-path). For
example, on linux:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  /usr/share/opencpn   =&gt;  ~/.local/share/opencpn
  /usr/bin             =&gt;  ~/.local/bin
  /usr/lib/opencpn     =&gt;  ~/.local/lib/opencpn</pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding substitutions are made on other platforms. For this to
work the tarball needs to have a specific layout like in examples below.
The example plugins contains:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A mandatory dynamic library oesenc (with platform dependent
mutations.)</p>
</li>
<li>
<p>A helper binary oeserverd</p>
</li>
<li>
<p>Data files: SymbolPatch5.xml and license.txt</p>
</li>
<li>
<p>Translations</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here is just a few file(s) of each kind mentioned; there are more of
them in the actual plugin.</p>
</div>
<div class="paragraph">
<p>Example macos layout</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  oesenc_pi-1.2.0-2
      ├── metadata.xml
      └──  OpenCPN.app
            └── Contents
                 ├── PlugIns
                 │   ├── liboesenc_pi.dylib
                 │   └── oeserverd
                 ├── Resources
                 │   ├── ar_SA.lproj
                 │   │    └── opencpn-oesenc_pi.mo
                 │   └── bg_BG.lproj
                 │        └── opencpn-oesenc_pi.mo
                 │
                 └── SharedSupport
                     └── plugins
                         └── oesenc_pi
                             └── data
                                 ├── license.txt
                                 └── SymbolPatch5.xml</pre>
</div>
</div>
<div class="paragraph">
<p>Example flatpak layout</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  oesenc_pi-flatpak-1.2.0/
      ├── metadata.xml
      ├── bin
      │   ├── oeserver
      │   └── oeserverd.prog
      ├── lib
      │   └── opencpn
      │       └── liboesenc_pi.so
      ├── manifest.json
      └── share
          ├── locale
          │   ├── ar_SA
          │   │   └── LC_MESSAGES
          │   │       └── opencpn-oesenc_pi.mo
          │   └── ca_ES
          │       └── LC_MESSAGES
          │           └── opencpn-oesenc_pi.mo
          └── opencpn
              └── plugins
                  └── oesenc_pi
                      └── data
                           ├── license.txt
                           └── SymbolPatch5.xml</pre>
</div>
</div>
<div class="paragraph">
<p>Example Ubuntu layout</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  oesenc_pi-1.2.0-2_ubuntu-16.04
      │
      ├── metadata.xml
      ├── bin
      │   └── oeserverd
      ├── lib
      │   └── opencpn
      │       ├── liboesenc_pi.so
      │       └── libsgllnx64-2.29.02.so
      └── share
          ├── locale
          │   ├── ar_SA
          │   │   └── LC_MESSAGES
          │   │       └── opencpn-oesenc_pi.mo
          │   └── bg_BG
          │       └── LC_MESSAGES
          │           └── opencpn-oesenc_pi.mo
          └── opencpn
              └── plugins
                  └── oesenc_pi
                      └── data
                          ├── license.txt
                          └── SymbolPatch5.xml</pre>
</div>
</div>
<div class="paragraph">
<p>The example shows the directories bin, lib and share in the top
directory. Having them as <code>/usr/\{bin, lib, share}</code> or
<code>/usr/local/\{bin, lib, share}</code> is also ok.</p>
</div>
<div class="paragraph">
<p>Example windows layout</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  oesenc_pi-1.2.0-2_msvc-10.0.14393
   ├── metadata.xml
   ├── plugins
   │   ├── oesenc_pi
   │   │   ├── data
   │   │   │   ├── license.txt
   │   │   │   └── SymbolPatch5.xml
   │   │   ├── msvcp140.dll
   │   │   ├── oeserverd.exe
   │   │   └── vcruntime140.dll
   │   └── oesenc_pi.dll
   └── share
         └── locale
               ├── ar_SA
               │   └── LC_MESSAGES
               │        └── opencpn-oesenc_pi.mo
               └── bg_BG
                   └── LC_MESSAGES
                        └── opencpn-oesenc_pi.mo</pre>
</div>
</div>
<div class="paragraph">
<p>Tarball names</p>
</div>
<div class="paragraph">
<p>The filename need to be unique and are formed like</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  &lt;plugin name&gt;-&lt;version&gt;[-release]_&lt;target os&gt;-&lt;target os version&gt;[-arch].tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>for example <code>oesenc_pi-1.2.0-3_ubuntu-18.04-armhf.tar.gz</code>. The release
and arch parts are optional and can be omitted.</p>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
